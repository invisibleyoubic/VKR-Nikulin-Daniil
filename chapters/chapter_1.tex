\newpage
\begin{center}
  \textbf{\large 1. ТЕОРЕТИЧЕСКАЯ ЧАСТЬ}
\end{center}
\refstepcounter{chapter}
\addcontentsline{toc}{chapter}{1. ТЕОРЕТИЧЕСКАЯ ЧАСТЬ}

\addcontentsline{toc}{subsubsection}{Потенциалы оценочнной функции}

\section{Потенциалы оценочной функции}

\subsection{Потенциал Кулона}


Потенциал Кулона -- это одна из основных концепций в физике, которая описывает взаимодействие заряженных частиц. Он является мерой энергии, необходимой для перемещения заряда от бесконечности до некоторой точки в пространстве, где располагается заряд, который создает электрическое поле.

Если имеются два заряда:  $q_1$ и $q_2$, установленные на расстоянии $r$ друг от друга, то заряд $q_1$ оказывает воздействие на заряд $q_2$ с силой 
\[ C_y= \frac{q_1 q_2}{\pi \varepsilon r^2}, \] 
где:
\begin{itemize}
	\item $\varepsilon$ -- это константа, которая зависит от свойств среды, в которой расположены заряды
\end{itemize}

В данном случае, электрическое поле образовано зарядом $q_1$, и потенциал Кулона этого поля в данной точке –- это энергия, необходимая для перемещения заряда из бесконечности (где потенциал равен нулю) в данную точку. Он рассчитывается по формуле: 
\[ V = \frac{k Q}{r}, \]
где:
\begin{itemize}
	\item $k = \frac{1}{4 \Pi \varepsilon}$
	\item3 $Q$ -- заряд
	\item $r$ -- расстояние между точкой и зарядом $Q$.
\end{itemize}

Знание потенциала Кулона важно для понимания многих явлений в электродинамике и физике зарядов. Например, знание потенциала Кулона может помочь в расчете энергии, необходимой для работы с зарядами или для определения действия различных сил в заряженных частицах.

Для решения многих физических задач, в которых участвуют заряды, часто используются линии уровня потенциала Кулона, которые изображаются в виде изолиний на графиках, что позволяет проще визуализировать электростатическую картину взаимодействия.

% Потом уберу - без этого не соберется бибтех
Тестовое упоминание источника \cite{test}

И1  \cite{ci500731a}

И2  \cite{biom10071056}

И3  \cite{Voter}

И4  \cite{chrushev}

И5  \cite{Voter}

И6  \cite{brooks}

И7  \cite{wu}

И8  \cite{rate, eef1}

И9 \cite{vcs}


\subsection{Потенциал Леннард-Джонса}

Потенциал Леннард-Джонса -- это математическая функция, которая используется для описания взаимодействия между частицами в некоторых моделях молекулярной динамики и статистической физики. Он был назван в честь физиков Джона Леннарда и Джона Джонса.

Функция потенциала Леннарда-Джонса зависит от расстояния между двумя частицами $r$ и имеет вид:
\[ V(r) = 4\varepsilon \left[ \left( \frac{\sigma}{r} \right)^{12} - \left( \frac{\sigma}{r} \right)^6 \right], \]
где:
\begin{itemize}
	\item $\varepsilon$ -- это глубина потенциальной ямы
	\item $\sigma$ -- это расстояние между частицами, при котором потенциальная энергия равна нулю.
\end{itemize}

Характерной особенностью этой функции является наличие двух слагаемых. Первое слагаемое описывает отталкивание между атомами при очень близких расстояниях ( $r < \sigma$ ), и имеет форму $\frac{\sigma^{12}}{r^{12}}$. Второе слагаемое описывает притяжение между атомами на более дистанционных расстояниях ( $r > \sigma$ ), и имеет форму $(-2\varepsilon) * \frac{\sigma^6)}{r^6}$.

У потенциала Леннарда-Джонса есть несколько важных свойств. Он является ограниченной функцией, т.е. у него есть минимальное значение, которое достигается при определенном значении расстояния между частицами. Это обуславливает специфические структуры, которые формируются в жидкостях, плохо растворяющимися газах и других системах в зависимости от параметров потенциала Леннарда-Джонса.

Потенциал Леннарда-Джонса используется в молекулярной динамике для симуляции взаимодействия между частицами жидкостей, газов и твердых тел. Это позволяет исследовать свойства систем, в которых используются молекулярные и атомные масштабы. Одним из наиболее важных приложений потенциала Леннарда-Джонса является моделирование систем белков и РНК в молекулярной биологии.


\subsection{Неявный растворитель}


Знание эффективной энергетической гиперповерхности биологических макромолекул в растворе имеет фундаментальное значение для понимания их свойств. Эффективная энергия (потенциал средней силы) для данной конформации макромолекулы представляет собой свободную энергию системы, состоящей из макромолекулы и растворителя, усредненную по всем степеням свободы растворителя при заданной температуре. Она состоит из внутримолекулярной энергии (энергия макромолекулы в вакууме) и энергии свободного растворения (свободная энергия переноса макромолекулы из газовой фазы в раствор). Общая свободная энергия системы макромолекула-растворитель в данной области гиперповерхности является суммой средней эффективной энергии и конфигурационной энтропии. В физиологических условиях обычно предполагается, что белки стабильны в окрестности глобального минимума (родной конформации), несмотря на большой прирост конфигурационной энтропии в денатурированном состоянии. Это называется "термодинамической гипотезой" стабильности белка, и имеющиеся данные свидетельствуют о ее справедливости для большинства малых однодоменных белков. Даже там, где эргодичность, кажется, нарушается, родное состояние должно соответствовать глубокому минимуму на эффективной энергетической гиперповерхности, который отделен от глобального минимума барьерами, слишком высокими для преодоления на экспериментальных временных шкалах. Теоретические прогнозы структуры белка из последовательности аминокислот и анализ механизма складывания требуют знания эффективной энергетической гиперповерхности и метода эффективного поиска конформационного пространства для определения расположения минимумов.

Всеатомные силовые поля, используемые в молекулярной механике и динамике симуляций макромолекул, дают энгию белка в вакууме. Только введя явный растворитель и проведя симуляции, показывающие как макромолекулу, так и растворитель, можно учитывать эффекты соляции. Из результатов симуляций и теоретических соображений ясно, что эффективная гиперповерхность энергии, включающая растворитель, значительно отличается от внутримолекулярной гиперповерхности энергии. Хотя внутримолекулярная гиперповерхность энергии часто имеет глубокий минимум около нативной конформации, она может иметь другие равно глубокие или более глубокие минимумы в отдаленных областях пространства конформации. Это может возникнуть из-за ряда эффектов. Например, взаимодействия полярных-неполярных групп в газовой фазе энергетически выгодны так же, как и полярные-неполярные взаимодействия. Однако в воде полярно-неполярные взаимодействия эффективно отталкивают из-за высокого штрафа за десольватацию полярной группы. Кроме того, гидрофобная гидратация делает эффективные взаимействия между неполярными группами в воде сильнее, чем в газовой фазе. Таким образом, вода способствует стабилизации нативного состояния с зарытыми неполярными группами и помогает гарантировать его уникальность. Взаимодействия противоположных зарядов менее стабилизирующие в воде, чем в вакууме. Таким образом, проблемы, связанные с складыванием и стабильностью белков, не могут быть решены без учета соляции.

Хотя за последние 40 лет был сделан значительный прогресс в статистической теории жидкостей, все еще отсутствуют простые и точные модели водной соляции. В настоящее время наиболее надежным методом учета соляции является симуляция белка в присутствии явных молекул воды. Однако этот подход связан с большими вычислительными затратами, и большая часть времени компьютера в таких симуляциях уходит на расчет взаимодействий растворителя-растворителя. Например в симуциях денатурации барназа система состояла из 1100 атомов белка и около 9000 атомов растворителя. Включение такого большого количества атомов растворителя ставит серьезные ограничения на тип проблем, которые можно изучать. Например, хотя динамику нативных состояний можно эффективно симулировать с помощью явных моделей растворителя, симуляции раскладки (и раскладанных состояний) на временных масштабах, необходимых для выборки достаточного количества различных начальных состояний для получения значимых сходимых результатов, пока что невозможны, за исключением, возможно, маленьких пептидов.

Еще одним ограничем симуляций явной соляции является то, что разница свободной энергии не получается прямым способом. Например, точное моделирование воды в нативной и неправильно свернутой структурах не показывает, какая из них имеет наименьшую свободную энергию. Требуется особая симуляция, включающая обратимый переход от одной конформации к другой или выборка по зонтику, чтобы можно было рассчитать необходимые различия в свободной энергии. Такие симуляции были проведены главным образом для малых молекул, таких как бутан, дипептиды и другие маленькие пептиды. Недавно потенциал средней силы для маленького белка относительно радиуса инерции в качестве параметра порядка был рассчитан с явным растворителем; для этой симуляции потребовалось 450 часов процессорного времени на 64-узловом Т3Е-суперкомпьютере (эквивалент 4 месяцам на стандартной рабочей станции) (личное сообщение C.L. Brooks). Таким образом, использованте этого подхода для изучения деталей сложенных и раскладанных состояний ряда белков, а также многих других проблем текущего интереса, все еще невозможно. 

Чтобы преодолеть ограничения вакуумных расчетов, с одной стороны, и явных симуляций растворителя, с другой, было разработано множество невных моделей соляции для белков, которые объединяют эмпирическое силовое поле для внутримолекулярных взаимодействий в вакууме с коррекцией сольвации. Последняя получается путем рассмотрения переноса всего белка или соответствующих составных групп из газовой фазы в воду. Очень простая модель использовала потенальную энергию CHARMM и коррекцию соляции на основе площади поверхности атома; были включены пять различных типов атомов. Та же модель соляции была объединена с силовым полем AMBER Шиффера. Фратернали и ван Гунстерен предложили еще более простую модель для использования в молекурной динамике (MD); эта модель также основана на доступных поверхностях и использует только два параметра - один для неполярных и один для полярных групп.

Хотя вышеупомянутые модели оценивают эффект соляции в терминах площади поверхности, нет фундаментального теоретического обоснования для этого выбора. Модель, которая не использует площадь поверхности, - это модель гидратационной оболочки. Она предполагает, что свободная энергия гидратации группы возникает из первой гидратационной оболочки и пропорциональна объему гидратационной оболочки, доступной растворителю (т.е. не занятой другими атомами растворителя). Еще один тип модели соляции основан на контактах, которые каждая группа устанавливает с другими атомами растворителя. Чем больше контактов, тем меньше величина свобной энергии соляции группы, и контакты взвешиваются в соответствии с некоторой функцией их расстояния от группы. Эта модель похожа на подходы, использованные ранее Гибсоном, Шерагой и Левиттом. Физически, модель Колонна-Чезари-Сандера похожа на модели площади поверхности, но она намного быстрее в использовании, потому что подсчет количества контактов занимает значительно меньше времени, чем даже самые эффективные аналитические методы расчета площади поверности. Кроме того, аналитические производные свободной энергии соляции могут быть легко получены для оценки сил, необходимых для минимизации энергии и молекулярной динамики. Версия этой модели была параметризована на основе свободных энергий гидратации малых молекул. Для каждой группы назначается параметр соляции. Модель была объединена с полем сил GROMOS и использована в стохастической динамической симуляции инибита трипсина поджелудочной железы крупного рогатого скота (BPTI). Было обнаружено, что полученные структуры были разумными, хотя отклонение от кристалличкой структуры было немного больше, чем в симуляциях с явной водой. 

Другой набор моделей сольватации рассматривает весь белок сразу и основан на континуальной электростатике и линеаризованном уравнении Пуассона-Больцмана. Поскольку численные решения уравнения Пуассона-Больцмана дороги, были предложены полуаналитические или аналитические приближения. Стилл ввел простое обобщение формулы Борна на многоатомные молекулы. Позднее обобщенное уравнение Борна было объединено с методом интегрированного поля для собственных энергий, что дало полностью аналитическую трактовку электростатических энергий и сил.38 Были сделаны приложения к ряду простых систем, и вполне вероятно, что этот подход будет использоваться более широко в будущем.

Описание модели.

Эффективная энергия $W(R^M)$ макромолекулы с координатами $R^M$ в решении может быть записана следующим образом:
\[W(R^M) = H_{intra}(R^M) + \Delta G^{slv}(R^M),\]
где $H_{intra}$ внутримакромолекулярная энергия, $\Delta G^{slv}$ свободная энергия растворителя. Чтобы получить данное уравнение , единственное предположение состоит в том, что гамильтониан является сепарабельным; то есть это сумма терминов раствор-раствор, раствор-растворитель и растворитель-растворитель. Так обстоит дело с большинством эмпирических функций энергии, которые не включают поляризацию. Недавняя теоретическая работа по термодинамике сольватации показала, что свободная энергия сольватации $\Delta G^{slv}$ заданной конформации $R^M$ может быть записана как интеграл по окружающему пространству; то есть,
\[\Delta G^{slv} = \int f(r)dr,\]
где $f(r)$ плотность свободной энергии сольватации в точке $r$. Она состоит из энергии расстворенного вещества-растворителя, энергии преобразования растворителя, энтропии раствора-растворителя и энтропии преобразования растворителя. Ожидается, что плотность свободной энергии растворителя сильно зависит от расстояния. Ее величина достигает максимума вблизи состояния раствора и стремится к нулю при отдалении от этого состояния. Когда две молекулы раствора приближаются друг к другу или изменяется конформация многоатомного раствора, сольватация каждой группы изменяется из-за двух эффектов: исключение растворителя из пространства, которое занято другими группами раствора, и изменение плотности ориентационного распределения растворителя в пространстве, которое не занято раствором. Для электростатических взаимодействий собственная энергия зарядов относится к первой категори, а диэлектрическое экранирование ко второй. В представленной модели упускается второй эффект для неполнярных групп, поскольку ожидается, что он будет незначительно малым, но он частично учитывается для полярных грпп за счет использования диэлетричской проницаемости, котороая зависит от расстояния. Предполагается, что для многоатомного раствора свободную энергию сольватации можно записать как сумму групп, то есть,
\[\Delta G^{slv} = \sum_i \Delta G_i^{slv},\]
где $\Delta G_i^{slv}$ свободная энерегия сольватации группы $i$. Выражение может быть формально получено путем рассмотрения энергии взаимодействия раствора и растворителя как суммы взаимодействия группы и растворителя и корреляционной функции раствора и растворителя как произведения корреляционных функций группы и растворителя. Принимая во внимание только эффект исключения растворителя, можно записать 
\[\Delta G_i^{slv} = \Delta G_i^{ref} - \sum_j \int_{V_j} f_i(r) dr,\]
где $\Delta G_i^{ref}$ (эталонная свободная энергия сольватации) -- свободная энергия сольватации $i$ в молекуле, выбранной подходящим образом, в которой группа $i$ практически полностью подвергается воздействию растворителя. Интеграл в выражении находится по объему $V_j$ группы $j$, а суммирование происходит по всем группам $j$ вокруг $i$. Для упрощения вычислений интеграл по $f_i(r)$ заменяется произведением $f_i(r_{ij})V_j$, то есть
\[\Delta G_i^{slv} = \Delta G_i^{ref} - \sum_{j \neq 1} f_i(r_{ij}) V_j,\]
где $r_{ij}$ расстояние между $i$ и $j$. Выражние сообщает, что свободная энергия сольватации группы $i$ равна энергии в модельной системе $\Delta G_i^{ref}$ за исключением сольватации из-за присутствия окружающих групп. Предполагаемая плотность свободной энергии сольватации определяется функцией Гаусса.
\[f_i(r) 4 \pi r^2 = \alpha_i exp(-x_i^2), x_i = \frac{r - R_i}{\lambda_i},\]
где $R_i$ -- ван дер Ваальсов радиус $i$, равный $\frac{1}{2}$ расстояния до энергетического минимума в потенциале Леннард-Джонса, $\lambda_i$ корреляционная длинна и $\alpha_i$ -- коэффициент пропорциональности, равный
\[\alpha_i = \frac{2 \Delta G_i^{free}}{\sqrt{\pi \lambda_i}},\]
где $\Delta G_i^{free}$ -- свободная энергия сольватации изолированной группы $i$; $\Delta G_i^{free}$ близка к $\Delta G_i^{ref}$, но не тождественно и определеяется эмпирически, требуя, чтобы свободная энергия сольватации глубоко лежащих групп равнялась нулю.


%Неявный растворитель -- это математическая модель, основанная на модели Гауссовских гидратных оболочек, которая используется для описания структуры гидратации белков и других макромолекул. Эта модель основана на предположении, что молекулы воды вблизи поверхности белка образовывают некоторую сферическую оболочку, в которой плотность молекул воды стремится к нулю. Разработчики использовали гауссовские функции, чтобы определить энергию гидратации каждого атома белка.

%Гидратная оболочка атома -- слой молекул воды, которые окружают атом и связаны с ним посредством водородных связей. То есть, гауссовские функции используются для моделирования гидратационной оболочки вокруг атомов белка, что позволяет более точно выполнить расчет энергии гидратации каждого отдельного атома.

%Модель Гауссовских гидратных оболочек предполагает, что размещение молекул воды в области гидратации с увеличением расстояния от белка может быть описано функцией Гаусса. Эта функция характеризуется средним значением и стандартным отклонением, которые определяют размеры и форму гидратной оболочки.

%Модель Гауссовских гидратных оболочек позволяет получить количественную оценку химических взаимодействий между белком и водой. В частности, эта модель используется для выявления ключевых аминокислотных остатков в белке, которые взаимодействуют с водой и играют важную роль в его структуре и функции.

%Более новые версии модели, такие как модель гидратации Майкросольвентной оболочки или модель Гижи-Шавитца, учитывают сильные динамические и корреляционные эффекты между молекулами воды и их взаимодействие с белком.

%Однако, важно понимать, что модель Гауссовских гидратных оболочек является лишь упрощенной моделью, которая не может учитывать полную динамику гидратации белка. Несмотря на это, она остается полезным инструментом для анализа структуры и функции белков в различных условиях.

%Формула неявного растворителя имеет вид:
%\[ E_s = \sum_i \Delta G_i + \sum_{i,j} \left( \frac{1}{2 \pi \sqrt{\pi}} \left[ -\Delta G_i e^{-\left( \tfrac{d_{ij} - {R_i}^{\textquotesingle}}{\lambda_i} \right)^2} - \Delta G_j e^{-\left( \tfrac{d_{ij} - {R_j}^{\textquotesingle}}{\lambda_j} \right)^2} \right] \right), \]
%где:
%\begin{itemize}
%	\item $d_{ij}$ -- евклидово расстояние между центрами атомов
%	\item $\lambda_i$ и $\lambda_j$ -- размеры гидратных оболочек атомов
%	\item ${R_i}^{\textquotesingle}$ и ${R_j}^{\textquotesingle}$ -- Ван-Дер-Ваальсовы радиусы атомов, которые соответствуют половине расстояния в потенциале Леннард-Джонса
%	\item $\Delta G_i$ и $\Delta G_j$ -- энергии гидратации в зависимости от типа атома
%\end{itemize}


\section{Kd-дерево}


Кd-дерево - это структура данных, которая позволяет эффективно хранить и обрабатывать точки в многомерном пространстве. Она используется для решения задач, связанных с поиском ближайших соседей, поиском точек в заданном диапазоне и кластеризацией данных.

Кd-дерево представляет собой бинарное дерево, в котором каждый узел соответствует гиперплоскости, разбивающей пространство на две части. Каждый узел содержит точку из множества, которое нужно организовать, а также указатели на двух потомков - левого и правого.

При поиске ближайших соседей или точек в заданном диапазоне, происходит спуск по дереву, выбирая тот узел, который содержит искомую точку. Затем происходит проверка точек в этом поддереве и, если они удовлетворяют условию поиска, то происходит их добавленик в результат. Если же поддерево не содержит искомую точку, происходит переход к следующему поддереву, пока не будет найдена нужная точка или не произведен обход всех поддеревьев.

Кd-дерево имеет ряд преимуществ перед другими структурами данных, такими как массивы или хэш-таблицы. Оно позволяет эффективно хранить и обрабатывать большие объемы данных, а также быстро выполнять операции поиска и обработки данных. Кd-дерево также может быть использовано для решения задач машинного обучения, таких как классификация и кластеризация данных.

Для построения Kd-дерева необходимо выбрать гиперплоскость, которая будет разбивать пространство на две части. Это можно сделать различными способами, например, выбрать гиперплоскость, которая проходит через среднюю точку множеств, или выбрать гиперплоскость, которая максимизирует расстояние между точками в разных поддеревьях.

При построении Kd-дерева также необходимо учитывать возможность перебора всех точек в заданном множестве. Для этого можно использовать различные алгоритмы, например, обход дерева в глубину или в ширину.

В целом, Kd-дерево -- эффективная структура данных, которая может быть использована для решения широкого спектра задач, связанных с обработкой данных в многомерном пространстве.